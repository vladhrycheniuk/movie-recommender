<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Movie Recommender</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header>
    <h1>🎬 Movie Recommender</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="recommendations.html">Recommendations</a>
      <a href="about.html">About</a>
    </nav>
  </header>

  <main>
    <!-- Популярні фільми -->
    <section>
      <h2>🔥 Popular Movies</h2>
      <div id="popular" class="results-grid"></div>
    </section>

    <!-- Пошук -->
    <section class="search-section">
      <h2>🔎 Search Movies</h2>
      <input type="text" id="search-input" placeholder="Enter movie title...">
      <button onclick="searchMovies()">Search</button>
    </section>

    <section id="results" class="results-grid"></section>
  </main>

  <script>
    const backendUrl = "http://127.0.0.1:8000";

    // Placeholder постери
    function getPosterUrl(title) {
        return `https://via.placeholder.com/200x300.png?text=${encodeURIComponent(title)}`;
    }

    async function loadPopular() {
      try {
        const response = await fetch(`${backendUrl}/popular`);
        const data = await response.json();
        document.getElementById("popular").innerHTML = data
          .map(movie => `
            <div class="card">
              <img src="${getPosterUrl(movie.title)}" alt="${movie.title}" class="poster">
              <h3>${movie.title}</h3>
              <p>ID: ${movie.movie_id}</p>
            </div>
          `).join("");
      } catch (err) {
        document.getElementById("popular").innerHTML = "<p style='color:red;'>Error loading popular movies</p>";
      }
    }

    async function searchMovies() {
      const query = document.getElementById("search-input").value.trim();
      if (!query) {
        document.getElementById("results").innerHTML = "<p>Please enter a search term.</p>";
        return;
      }
      try {
        const response = await fetch(`${backendUrl}/search?query=${encodeURIComponent(query)}`);
        const data = await response.json();
        document.getElementById("results").innerHTML = data.length > 0
          ? data.map(movie => `
            <div class="card">
              <img src="${getPosterUrl(movie.title)}" alt="${movie.title}" class="poster">
              <h3>${movie.title}</h3>
              <p>ID: ${movie.movie_id}</p>
            </div>
          `).join("")
          : "<p>No results found.</p>";
      } catch (err) {
        document.getElementById("results").innerHTML = "<p style='color:red;'>Error fetching results</p>";
      }
    }

    loadPopular();
  </script>
</body>
</html>
